---
title: NF05
description: Auditing
dimension: non functional
tags: [auditing,logging]
nav_order: 2.55

requirement: |
  Audit & logging requirements **SHOULD** be defined, and the solution can support them. NCSC Logging and Protective Monitoring NCSC Principle 13: Audit information and alerting for customers


more_info: |
  Intent:
    Ensure security, forensic and compliance needs are met through comprehensive
    auditable logging with integrity and timely analysis.

  Logging scope:
    - Authentication & authorisation events
    - Data access (read/write of sensitive entities)
    - Administrative actions / configuration changes
    - Security-relevant system events (process start, privilege escalation)
    - Business-critical domain events (financial, clinical actions)

  Design considerations:
    - Structured JSON with schema version
    - Time synchronisation (NTP) & monotonic ordering where possible
    - Tamper resistance (append-only store / write-once retention)
    - Correlation (request IDs, user IDs, session IDs)
    - Retention & purge per regulation

  Pitfalls:
    - Sensitive data leakage in logs (PII, secrets)
    - Unbounded log volume growth (cost & noise)
    - Lack of parsing standards -> brittle analytics queries

examples: 
    - title: Audit Log Entry Schema
      content: |
        { timestamp, actorId, action, resourceType, resourceId, outcome, traceId }
    - title: Tamper Evident Storage Diagram
      content: |
        Logging pipeline writing to immutable bucket with hash chain.
    - title: Alert Rule Example
      content: |
        Trigger on >5 failed privileged actions per minute from single source.

technology:
    - title: Central Log Pipeline (FluentBit / Vector)
      content: |
        Normalises & ships structured logs.
    - title: SIEM Platform (Splunk / Sentinel)
      content: |
        Correlates events & raises alerts.
    - title: Integrity Store (WORM / Hash Chain)
      content: |
        Ensures tamper evidence for forensic needs.

further_reading:
    - title: NCSC Logging & Monitoring Guidance
      content: UK government logging best practice.
      url: https://www.ncsc.gov.uk/
    - title: OWASP Logging Cheat Sheet
      content: Secure logging recommendations.
      url: https://cheatsheetseries.owasp.org/

assessment_guidance: |
  Assessment focus:
    Ensure audit logging is comprehensive, secure, tamper-evident and operationally actionable.

  Steps:
    1. Review audit schema: confirm required fields & absence of sensitive data (sample 100 log lines automated scan).
    2. Validate immutability: check storage configuration (WORM / hash chaining) & recent integrity verification report.
    3. Select 2 high-risk actions (privilege change, data export): ensure alerts & runbooks exist, test their trigger conditions.
    4. Inspect retention & purge automation logs for compliance with policy.
    5. Evaluate parsing / normalisation success (error rate of ingestion pipeline, field population completeness).

  Evidence:
    - Schema definition file
    - Integrity verification output
    - Alert rule & runbook reference
    - Retention purge job log snippet

  Red flags:
    - Plaintext credentials / PII in logs
    - Manual integrity checks only (no automated assurance)
    - High ingestion parse failure rate

  Maturity signals:
    - Real-time anomaly detection leveraging enriched audit events
    - Automated schema drift detection
    - Correlated security investigations using consistent IDs

  Quick improvements:
    - Add automated sensitive-field redaction tests
    - Implement hash chain verification cron job
    - Standardise audit action taxonomy documentation

auditing:
  - https://www.ncsc.gov.uk/collection/device-security-guidance/managing-deployed-devices/logging-and-protective-monitoring 
  - https://www.ncsc.gov.uk/collection/cloud/the-cloud-security-principles/principle-13-audit-information-and-alerting-for-customers 

assessment_examples:
  "0":
    - example: Audit events incomplete (missing user/action) and stored locally with no retention policy.
    - example: Sensitive data occasionally exposed in logs; no redaction safeguards.
  "1":
    - example: Central log aggregation present but schema inconsistent across services; integrity not ensured.
    - example: Manual reviews after incidents only; no proactive alerting on critical actions.
  "2":
    - example: Structured schema adopted for most services; baseline alert rules for auth failures configured.
    - example: Retention policy defined but purge / WORM enforcement not validated.
  "3":
    - example: Tamper-evident storage (WORM/hash chain) implemented; periodic integrity verification reports produced.
    - example: High-risk actions generate alerts with linked runbooks and measurable response SLAs.
  "4":
    - example: Automated schema drift detection; redaction unit tests gate merges.
    - example: Audit analytics correlates actions across services enabling rapid forensic timelines.
  "5":
    - example: Real-time anomaly detection models behavioural deviations from baseline (UEBA-style) reducing false positives.
    - example: Compliance evidence auto-packaged with cryptographic attestations for audits.

---
<ul>
{%- for audit in page.auditing  -%}
<li>
{{ audit  | markdownify}}
</li>
{% endfor %}
<ul>
